name: Hugo

on: [push]

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v1
    - uses: falti/dotenv-action@v0.2.4
      id: dotenv
    - name: Clean site
      run: |
        rm -rf docs/*
    - name: hugo build
      uses: klakegg/actions-hugo@1.0.0
      with:
        version: ${{ steps.dotenv.outputs.hugo_version }}
        image: ${{ steps.dotenv.outputs.hugo_image }}
        env: production
        target: public
    - name: deploy build
      run: |
        git config user.name "${GITHUB_ACTOR}"
        git config user.email "${GITHUB_ACTOR}@users.noreply.github.com"
        git add -f public/*
        git commit -am "ðŸš€ Deploy with ${GITHUB_WORKFLOW}"
        git push --all https://${{ secrets.GITHUB_TOKEN }}@github.com/${GITHUB_REPOSITORY}.git
